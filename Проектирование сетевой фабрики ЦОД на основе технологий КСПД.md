
---

### **Практическая работа №1**
**Тема:** «Проектирование сетевой фабрики ЦОД на основе технологий КСПД»

**Цель работы:** Освоить принципы выбора и концептуального проектирования сетевой фабрики центра обработки данных (ЦОД) с использованием технологий Коммутируемых Систем Пакетной Доставки (КСПД).

**Задача:** На основе предложенного сценария спроектировать логическую и физическую схему сетевой фабрики, обосновать выбор технологии и описать план реализации.

---

### **Ликбез и Теоретическая справка для выполнения задания**

Прежде чем приступить к заданию, давайте разберемся с ключевыми понятиями.

#### **1. Что такое КСПД (Commodity Switching)?**
КСПД — это философия и подход к построению сетей, при котором вместо дорогостоящих монолитных коммутаторов "все-в-одном" используются массовые, относительно дешевые коммутаторы (commodity), а вся интеллектуальная логика (управление, маршрутизация, политики) выносится в программный контроллер или операционную систему.

*   **Аналогия:** Раньше были дорогие "умные" телефоны с кнопками. Сегодня у нас массовые "глупые" смартфоны (железо), а весь интеллект — в операционной системе (iOS/Android) и приложениях. Так и в КСПД: "глупые" коммутаторы + "умная" ОС/контроллер.

#### **2. Что такое Сетевая Фабрика (Fabric)?**
Это не просто набор коммутаторов, соединенных друг с другом. Это единая, логически цельная система, где:
*   **Любой узел (сервер)** может связаться с любым другим узлом с минимальной задержкой.
*   **Есть множество путей** между точками для отказоустойчивости и балансировки нагрузки.
*   **Управление централизованное** (или распределенно-централизованное), что упрощает настройку и внесение изменений.

**Цель фабрики:** преодолеть ограничения традиционных древовидных (Tree) или многоуровневых (Core-Aggregation-Access) архитектур, которые имеют "узкие места" (bottlenecks) и сложны в масштабировании.

#### **3. Ключевые технологии для построения фабрик в парадигме КСПД:**

*   **Ethernet Fabrics:**
    *   **Cisco FabricPath** (устаревший, но важный для понимания)
    *   **Juniper QFabric** (концептуально)
    *   **Brocade VCS Fabric**

*   **Технологии на основе протокола IS-IS / TRILL:**
    *   **TRILL (Transparent Interconnection of Lots of Links):** Позволяет строить беспетлевые логические топологии поверх физической сетки (mesh).
    *   **SPB (Shortest Path Bridging):** Альтернатива TRILL, стандартизованная IEEE.

*   **Программно-определяемые сети (SDN):**
    *   **Контроллеры (ONOS, OpenDaylight) + протокол OpenFlow.** Контроллер "видит" всю сеть и вычисляет оптимальные пути, программируя потоки (flows) на коммутаторах.

*   **Disaggregated Networking (Разъединенные сети):**
    *   **"Белая" железка (White-box Switch):** Аппаратный коммутатор от ODM-производителя (например, Edgecore, Quanta).
    *   **Сетевая ОС (NOS):** Независимое ПО, которое устанавливается на белую железку (например, SONiC, Dell OS10, Cumulus Linux, FRR).

**Современный тренд — это комбинация: White-box switches + Open NOS (например, SONiC) + SDN-контроллер/протокол (например, BGP-EVPN).**

---

### **Подсказки по выполнению задания (Пошаговый план)**

Используйте этот план как чек-лист для своей работы.

**Шаг 1: Анализ требований и выбор технологии**
*   Проанализируйте предложенный сценарий. Какие приложения будут работать? (Web-сервисы, СУБД, Big Data).
*   Определите **критические параметры**:
    *   **Требования к задержке (Latency):** Для СУБД и высокопроизводительных вычислений (HPC) — критично.
    *   **Пропускная способность (Throughput):** Требования "восток-запад" (трафик между серверами внутри ЦОД) vs "север-юг" (трафик из/в интернет).
    *   **Масштабируемость:** Планируется ли рост стойок и серверов?
    *   **Виртуализация:** Много ли виртуальных машин, контейнеров? Нужна ли поддержка overlay-сетей (VXLAN)?
*   **Выберите технологию фабрики** и кратко обоснуйте выбор (см. варианты выше). Например: "Для данного сценария с высокими требованиями к "восток-запад" трафику и виртуализацией выбираем BGP-EVPN с VXLAN на базе белых коммутаторов под управлением ОС SONiC".

**Шаг 2: Проектирование логической схемы (L2/L3 Design)**
*   **Определись с моделью сети:** Будет ли это чисто L2-фабрика (редко) или L3-фабрика (современный стандарт)? L3 до самого сервера (Leaf-and-Spine) — лучшая практика.
*   **Нарисуйте логическую схему топологии.** Стандарт де-факто — **Leaf-and-Spine**.
    *   **Leaf (лист):** Коммутаторы доступа, к которым подключаются серверы.
    *   **Spine (спайн/хребет):** Коммутаторы ядра, к которым по принципу "каждый-с-каждым" подключаются все Leaf-коммутаторы.
    *   Покажи на схеме, как серверы подключаются к Leaf, а Leaf — ко всем Spine. Это создает предсказуемую и масштабируемую сетку.
*   **Продумай IP-план.** Например, для адресации линков между Leaf и Spine используйте сеть /31.

**Шаг 3: Проектирование физической схемы**
*   Нарисуйте упрощенную физическую схему. Покажи 2-4 стоечных шкафа.
*   В каждом шкафу размести по 1-2 Leaf-коммутатора (для резервирования).
*   Выдели отдельные шкафы для Spine-коммутаторов (обычно 2-4 штуки для начала).
*   Покажи физические соединения (толстыми линиями, символизирующими multiple 10/25/100GbE каналы) от каждого Leaf до каждого Spine.

**Шаг 4: Выбор стека технологий (Technology Stack)**
*   **Аппаратная часть (Hardware):** Предложи тип коммутаторов. Например: "Leaf — коммутаторы с 48 портами 25GbE и 6 портами 100GbE для аплинков; Spine — коммутаторы с 32 портами 100GbE".
*   **Программная часть (Software):** Какая сетевая ОС? Будет ли контроллер? Например: "Используем ОС SONiC на всех коммутаторах. Для управления префиксами и политиками используем BGP в качестве протокола маршрутизации под капотом SONiC".
*   **Протоколы:** Какие протоколы будут "склеивать" фабрику? (e.g., BGP-EVPN для обмена MAC/IP маршрутами поверх VXLAN туннелей).

**Шаг 5: План реализации и тестирования**
*   **Фаза 1:** Развертывание Spine-коммутаторов и их соединение.
*   **Фаза 2:** Развертывание первого Leaf-коммутатора, подключение к всем Spine, настройка протоколов.
*   **Фаза 3:** Подключение тестовых серверов, проверка связности.
*   **Фаза 4:** Постепенное добавление остальных Leaf-коммутаторов и серверов.
*   **Тесты:** Что будем проверять?
    *   Ping между серверами в разных стойках.
    *   IPerf для проверки пропускной способности.
    *   Отказоустойчивость: выдергиваем кабель из одного Spine, проверяем, как трафик переключается на другой путь.

---

### **Пример выполнения (Шаблон для отчета в Word .docx  и отправить на почту soft.box.development.com )**

**1. Сценарий:** Проектирование нового ЦОД для интернет-магазина. Ожидается 50 стоек, высокая нагрузка между веб-серверами, серверами приложений и СУБД. Требуется низкая задержка и поддержка виртуальной инфраструктуры.

**2. Анализ и выбор технологии:**
*   **Требования:** Высокий "восток-запад" трафик, низкая задержка, поддержка VXLAN.
*   **Выбор:** Архитектура Leaf-and-Spine на основе белых коммутаторов с ОС SONiC. В качестве протокола управления префиксами используется BGP-EVPN. Это обеспечивает отказоустойчивость, масштабируемость и позволяет создавать overlay-сети поверх физической L3-фабрики.

**3. Логическая схема (описание):**
*   Топология: Clos (Leaf-and-Spine).
*   Количество Spine: 4.
*   Количество Leaf: 50 (по одному на стойку на первом этапе, с планом увеличения до двух для резервирования).
*   Каждый Leaf соединен с каждым Spine на скорости 100GbE.
*   Серверы подключаются к Leaf на скорости 25GbE.

*(Здесь должна быть диаграмма, отрисованная в draw.io, Lucidchart и т.д.)*

[Место для схемы]

**4. Физическая схема (описание):**
*   Spine-коммутаторы размещены в двух отдельных шкафах (по 2 устройства в каждом) для физического резервирования.
*   Leaf-коммутаторы размещены в серверных стойках.
*   Все соединения Leaf-Spine дублированы и проходят по разным физическим путям.

*(Здесь должна быть упрощенная физическая схема)*

[Место для схемы]

**5. Стек технологий:**
*   **Hardware:** Spine - 32x100GbE порта (White-box, например, на базе чипа Tomahawk); Leaf - 48x25GbE + 8x100GbE портов.
*   **Software/NOS:** SONiC (Software for Open Networking in the Cloud).
*   **Протоколы:** BGP (Unnumbered) для Underlay-сети, BGP EVPN для обмена маршрутами L2/L3 в Overlay (VXLAN).

**6. План реализации:**
1.  Установка и базовая настройка 4x Spine-коммутаторов.
2.  Настройка BGP между Spine (как Route-Server).
3.  Установка первого тестового Leaf, настройка BGP-сессий со всеми Spine.
4.  Подключение тестовых серверов, создание VXLAN-сети, проверка связности.
5.  Поэтапное добавление остальных Leaf-коммутаторов по мере готовности стоек.

